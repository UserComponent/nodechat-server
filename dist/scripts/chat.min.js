!function(e,t){var s,n,r,o;return o=t(),e(function(){var t,n,a,h,i,l;return t=e(window),n=e("#nc-message-form"),a=e("#nc-message-compose"),h=new s("#nc-messages-container"),i=e(".ns-chat-toggle"),l=i.filter('[name="toggle-theme"]'),i.bootstrapSwitch(),t.on("resize",function(){return h.resize()}),o.on("chat-message",function(e){return h.addMessage(e)}).on("chat-enter",function(e){return h.addMessage(e+" entered","text-muted nc-chat-enter-text")}).on("chat-exit",function(e){return h.addMessage(e+" left","text-muted nc-chat-exit-text")}),t.add(a).bind("keyup","ctrl+shift+l",function(e){return h.clear()}),n.on("submit",function(e){var t;switch(e.preventDefault(),a.val()){case"":break;case"/clear":h.clear();break;case"/theme:light":case"/theme:dark":t=a.val().split(":")[1],r.set(t),l.bootstrapSwitch("state","dark"===t,!0);break;default:o.emit("chat-message",a.val())}return a.val("")}),l.on("switchChange.bootstrapSwitch",function(e,t){return t===!0?r.set("dark"):r.set("light")})}),n=function(){function e(){}return e.hyperlinkTLD=["com","us","ca","net","eu","tv","gov","org"],e.tagHyperlinks=function(e){var t;return t=new RegExp("(https?\\:\\/\\/)?((?:www)?\\S+\\.(?:"+this.hyperlinkTLD.join("|")+"))","gi"),e.replace(t,'<a href="http://$2" target="_blank">$1$2</a>')},e}(),r=function(){function t(){}return t.stylesheetElement=e("#nc-chat-stylesheet"),t.stylesheets={light:"/styles/chat-light.min.css",dark:"/styles/chat-dark.min.css"},t.set=function(e){var t;return null!=this.stylesheets[e]?(this.stylesheetElement.attr("href",this.stylesheets[e]),t=!0):(console.error("stylesheet not found: "+e),t=!1),t},t}(),s=function(){function t(t){this.elem=e(t),this.pusher=null,this.resize(),this.clear()}return t.sounds={message:new Howl({urls:["/sounds/message.mp3","/sounds/message.m4r"]})},t.prototype.soundsEnabled=!0,t.prototype.resize=function(){var t;return t=e("#nc-message-form"),this.height=Math.ceil(t.offset().top)-16,this.height-=this.elem.offset().top,this.elem.css("height",this.height)},t.prototype.clear=function(){var t;return t=this.pusher,this.pusher=e(document.createElement("div")),this.pusher.addClass("nc-chat-buffer-pusher").height(this.height).appendTo(this.elem),this.scrollToBottom(),t?t.remove():void 0},t.prototype.addMessage=function(t,s){var r,o,a;return null==s&&(s=""),o=e(document.createElement("li")),a=null!=t.author?t.author+": "+t.content:t,r=n.tagHyperlinks(a),o.addClass(("nc-chat-message-item "+s).trim()).html(r).appendTo(this.elem),this.pusher&&this.pusher.height(Math.floor(this.pusher.height()-o.outerHeight(!0))),this.scrollToBottom(),t.author?this.playSound("message"):void 0},t.prototype.playSound=function(e){var s;return null!=t.sounds[e]?this.soundsEnabled?(t.sounds.message.play(),s=!0):s=!1:(console.error("sound not found: "+e),s=!1),s},t.prototype.scrollToBottom=function(){return this.elem.scrollTop(this.elem[0].scrollHeight)},t}()}(jQuery,io);