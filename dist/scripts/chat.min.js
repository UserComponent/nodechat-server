!function(e,t){var s,n,r,h;return h=t(),e(function(){var t,n,o,i,a,c;return t=e(window),n=e("#nc-message-form"),o=e("#nc-message-compose"),i=new s("#nc-messages-container"),a=e(".ns-chat-toggle"),c=a.filter('[name="toggle-theme"]'),a.bootstrapSwitch(),t.on("resize",function(){return i.resize()}),h.on("chat-message",function(e){return i.addMessage(e)}).on("chat-enter",function(e){return i.addMessage(e+" entered","text-muted nc-chat-enter-text")}).on("chat-exit",function(e){return i.addMessage(e+" left","text-muted nc-chat-exit-text")}),t.add(o).bind("keyup","ctrl+shift+l",function(e){return i.clear()}),n.on("submit",function(e){var t;switch(e.preventDefault(),o.val()){case"":break;case"/clear":i.clear();break;case"/theme:light":case"/theme:dark":t=o.val().split(":")[1],r.set(t),c.bootstrapSwitch("state","dark"===t,!0);break;default:h.emit("chat-message",o.val())}return o.val("")}),c.on("switchChange.bootstrapSwitch",function(e,t){return t===!0?r.set("dark"):r.set("light")})}),n=function(){function e(){}return e.hyperlinkTLD=["com","us","ca","net","eu","tv","gov","org"],e.tagHyperlinks=function(e){var t;return t=new RegExp("(https?\\:\\/\\/)?((?:www)?\\S+\\.(?:"+this.hyperlinkTLD.join("|")+"))","gi"),e.replace(t,'<a href="http://$2" target="_blank">$1$2</a>')},e}(),r=function(){function t(){}return t.stylesheetElement=e("#nc-chat-stylesheet"),t.stylesheets={light:"/styles/chat-light.min.css",dark:"/styles/chat-dark.min.css"},t.set=function(e){var t;return null!=this.stylesheets[e]?(this.stylesheetElement.attr("href",this.stylesheets[e]),t=!0):(console.error("stylesheet not found: "+e),t=!1),t},t}(),s=function(){function t(t){this.elem=e(t),this.pusher=null,this.resize(),this.clear()}return t.sounds={message:new Howl({urls:["/sounds/message.mp3","/sounds/message.m4r"]})},t.prototype.resize=function(){var t;return t=e("#nc-message-form"),this.height=Math.ceil(t.offset().top)-16,this.height-=this.elem.offset().top,this.elem.css("height",this.height)},t.prototype.clear=function(){var t;return t=this.pusher,this.pusher=e(document.createElement("div")),this.pusher.addClass("nc-chat-buffer-pusher").height(this.height).appendTo(this.elem),this.scrollToBottom(),t?t.remove():void 0},t.prototype.addMessage=function(s,r){var h,o,i;return null==r&&(r=""),o=e(document.createElement("li")),i=s.author?s.author+": "+s.content:s,h=n.tagHyperlinks(i),o.addClass(("nc-chat-message-item "+r).trim()).html(h).appendTo(this.elem),this.pusher&&this.pusher.height(Math.floor(this.pusher.height()-o.outerHeight(!0))),this.scrollToBottom(),s.author?t.sounds.message.play():void 0},t.prototype.scrollToBottom=function(){return this.elem.scrollTop(this.elem[0].scrollHeight)},t}()}(jQuery,io);