!function(e,t){var s,n,o,r;return r=t(),e(function(){var t,n,a,i,h,u,l;return t=e(window),n=e("#nc-message-form"),a=e("#nc-message-compose"),i=new s("#nc-messages-container"),h=e(".ns-chat-toggle"),l=h.filter('[name="toggle-theme"]'),u=h.filter('[name="toggle-sound"]'),h.bootstrapSwitch(),t.on("resize",function(){return i.resize()}),r.on("chat-message",function(e){return i.addMessage(e)}).on("chat-enter",function(e){return i.addMessage(e+" entered","text-muted nc-chat-enter-text")}).on("chat-exit",function(e){return i.addMessage(e+" left","text-muted nc-chat-exit-text")}),t.add(a).bind("keyup","ctrl+shift+l",function(e){return i.clear()}),n.on("submit",function(e){var t,s,n;switch(e.preventDefault(),n=a.val()){case"":break;case"/clear":i.clear();break;case"/theme light":case"/theme dark":s=n.split(" ")[1],o.set(s),l.bootstrapSwitch("state","dark"===s,!0);break;case"/sound on":case"/sound off":case"/sounds on":case"/sounds off":t=n.split(" ")[1],i.soundsEnabled="on"===t,u.bootstrapSwitch("state",i.soundsEnabled,!0);break;default:r.emit("chat-message",n)}return a.val("")}),l.on("switchChange.bootstrapSwitch",function(e,t){return t===!0?o.set("dark"):o.set("light")}),u.on("switchChange.bootstrapSwitch",function(e,t){return t===!0?i.soundsEnabled=!0:i.soundsEnabled=!1})}),n=function(){function e(){}return e.hyperlinkTLD=["com","us","ca","net","eu","tv","gov","org"],e.tagHyperlinks=function(e){var t;return t=new RegExp("(https?\\:\\/\\/)?((?:www)?\\S+\\.(?:"+this.hyperlinkTLD.join("|")+"))","gi"),e.replace(t,'<a href="http://$2" target="_blank">$1$2</a>')},e}(),o=function(){function t(){}return t.stylesheetElement=e("#nc-chat-stylesheet"),t.stylesheets={light:"/styles/chat-light.min.css",dark:"/styles/chat-dark.min.css"},t.set=function(e){var t;return null!=this.stylesheets[e]?(this.stylesheetElement.attr("href",this.stylesheets[e]),t=!0):(console.error("stylesheet not found: "+e),t=!1),t},t}(),s=function(){function t(t){this.elem=e(t),this.pusher=null,this.resize(),this.clear()}return t.sounds={message:new Howl({urls:["/sounds/message.mp3","/sounds/message.m4a"]})},t.prototype.soundsEnabled=!0,t.prototype.resize=function(){var t;return t=e("#nc-message-form"),this.height=Math.ceil(t.offset().top)-16,this.height-=this.elem.offset().top,this.elem.css("height",this.height)},t.prototype.clear=function(){var t;return t=this.pusher,this.pusher=e(document.createElement("div")),this.pusher.addClass("nc-chat-buffer-pusher").height(this.height).appendTo(this.elem),this.scrollToBottom(),t?t.remove():void 0},t.prototype.addMessage=function(t,s){var o,r,a;return null==s&&(s=""),r=e(document.createElement("li")),a=null!=t.author?t.author+": "+t.content:t,o=n.tagHyperlinks(a),r.addClass(("nc-chat-message-item "+s).trim()).html(o).appendTo(this.elem),this.pusher&&this.pusher.height(Math.floor(this.pusher.height()-r.outerHeight(!0))),this.scrollToBottom(),t.author?this.playSound("message"):void 0},t.prototype.playSound=function(e){var s;return null!=t.sounds[e]?this.soundsEnabled?(t.sounds.message.play(),s=!0):s=!1:(console.error("sound not found: "+e),s=!1),s},t.prototype.scrollToBottom=function(){return this.elem.scrollTop(this.elem[0].scrollHeight)},t}()}(jQuery,io);